{% extends "base.html" %}
{% block content %}

<h2>Billing</h2>

{% if error %}
<p style="color:red;">{{ error }}</p>
{% endif %}

<h3>Generate Bill</h3>

<form method="post">
    {% csrf_token %}
    <label>Select Table:</label>
    <select name="table" required>
        {% for table in tables %}
        <option value="{{ table.id }}">
            Table {{ table.table_number }} ({{ table.status }})
        </option>
        {% endfor %}
    </select>
    <button type="submit">Generate Bill</button>
</form>

<hr>

<h3>Existing Bills</h3>

<table>
    <tr>
        <th>Table</th>
        <th>Subtotal</th>
        <th>Tax</th>
        <th>Total</th>
        <th>Status</th>
        <th>Action</th>
    </tr>

    {% for bill in bills %}
    <tr>
        <td>Table {{ bill.table.table_number }}</td>
        <td>{{ bill.subtotal }}</td>
        <td>{{ bill.tax }}</td>
        <td>{{ bill.total }}</td>
        <td>{{ bill.status }}</td>
        <td>
            {% if bill.status != "PAID" %}
            <a href="/billing/pay/{{ bill.id }}/">Mark Paid</a>
            {% else %}
            Paid
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>

{% endblock %}
